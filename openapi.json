{"openapi":"3.1.0","info":{"title":"Auto Leadsheet API","description":"API for managing leadsheet generation jobs and songs","version":"0.1.0"},"paths":{"/jobs":{"post":{"tags":["jobs"],"summary":"Create New Job","description":"Create a new job.","operationId":"create_new_job_jobs_post","responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobResponse"}}}}},"security":[{"HTTPBearer":[]}]}},"/jobs/{job_id}":{"get":{"tags":["jobs"],"summary":"Get Job Details","description":"Get job details by ID.","operationId":"get_job_details_jobs__job_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/jobs/{job_id}/status":{"get":{"tags":["jobs"],"summary":"Get Job Status","description":"Get job status by ID.","operationId":"get_job_status_jobs__job_id__status_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/jobs/{job_id}/run-allin1":{"post":{"tags":["jobs"],"summary":"Trigger Allin1 Job","description":"Trigger the allin1 analysis Cloud Run job. Returns immediately without waiting.","operationId":"trigger_allin1_job_jobs__job_id__run_allin1_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RunJobResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/jobs/{job_id}/run-chord":{"post":{"tags":["jobs"],"summary":"Trigger Chord Job","description":"Trigger the chord analysis Cloud Run job. Returns immediately without waiting.","operationId":"trigger_chord_job_jobs__job_id__run_chord_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RunJobResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/jobs/{job_id}/songs":{"get":{"tags":["songs"],"summary":"List Songs","description":"List all songs in a job.","operationId":"list_songs_jobs__job_id__songs_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SongsListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["songs"],"summary":"Create New Song","description":"Create a new song in a job.","operationId":"create_new_song_jobs__job_id__songs_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateSongRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SongResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/jobs/{job_id}/songs/{song_id}":{"get":{"tags":["songs"],"summary":"Get Song Details","description":"Get song details by ID.","operationId":"get_song_details_jobs__job_id__songs__song_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}},{"name":"song_id","in":"path","required":true,"schema":{"type":"string","title":"Song Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SongResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/jobs/{job_id}/songs/{song_id}/status":{"get":{"tags":["songs"],"summary":"Get Song Status","description":"Get song status by ID.","operationId":"get_song_status_jobs__job_id__songs__song_id__status_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}},{"name":"song_id","in":"path","required":true,"schema":{"type":"string","title":"Song Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SongStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/jobs/{job_id}/songs/{song_id}/upload-url":{"get":{"tags":["songs"],"summary":"Get Upload Url","description":"Get a signed URL for uploading audio to this song.\n\nThe signed URL is valid for 15 minutes and should be used with a PUT request.","operationId":"get_upload_url_jobs__job_id__songs__song_id__upload_url_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}},{"name":"song_id","in":"path","required":true,"schema":{"type":"string","title":"Song Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UploadUrlResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"tags":["health"],"summary":"Health Check","description":"Health check endpoint for Cloud Run readiness probes.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}}},"components":{"schemas":{"CreateSongRequest":{"properties":{"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"artist":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Artist"},"file_type":{"type":"string","title":"File Type","default":"mp3"}},"type":"object","title":"CreateSongRequest","description":"Request model for creating a song."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthResponse":{"properties":{"status":{"type":"string","title":"Status","default":"ok"}},"type":"object","title":"HealthResponse","description":"Response model for health check."},"JobResponse":{"properties":{"job_id":{"type":"string","title":"Job Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"status":{"$ref":"#/components/schemas/JobStatusEnum"},"allin1_execution":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Allin1 Execution"},"chord_execution":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Chord Execution"}},"type":"object","required":["job_id","created_at","updated_at","status"],"title":"JobResponse","description":"Response model for a job."},"JobStatusEnum":{"type":"string","enum":["PENDING","UPLOADING","ANALYZING","FAILED","CANCELLED","SUCCESS"],"title":"JobStatusEnum","description":"Status values for a job or song."},"JobStatusResponse":{"properties":{"job_id":{"type":"string","title":"Job Id"},"status":{"$ref":"#/components/schemas/JobStatusEnum"}},"type":"object","required":["job_id","status"],"title":"JobStatusResponse","description":"Response model for job status only."},"RunJobResponse":{"properties":{"job_id":{"type":"string","title":"Job Id"},"execution_id":{"type":"string","title":"Execution Id"}},"type":"object","required":["job_id","execution_id"],"title":"RunJobResponse","description":"Response after triggering a Cloud Run job."},"SongResponse":{"properties":{"song_id":{"type":"string","title":"Song Id"},"chord_status":{"$ref":"#/components/schemas/JobStatusEnum"},"allin1_status":{"$ref":"#/components/schemas/JobStatusEnum"},"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"artist":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Artist"},"audio_path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Audio Path"},"chords_path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Chords Path"},"allin1_path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Allin1 Path"},"size":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Size"},"length":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Length"}},"type":"object","required":["song_id","chord_status","allin1_status"],"title":"SongResponse","description":"Response model for a song."},"SongStatusResponse":{"properties":{"song_id":{"type":"string","title":"Song Id"},"chord_status":{"$ref":"#/components/schemas/JobStatusEnum"},"allin1_status":{"$ref":"#/components/schemas/JobStatusEnum"}},"type":"object","required":["song_id","chord_status","allin1_status"],"title":"SongStatusResponse","description":"Response model for song status only."},"SongsListResponse":{"properties":{"job_id":{"type":"string","title":"Job Id"},"songs":{"items":{"$ref":"#/components/schemas/SongResponse"},"type":"array","title":"Songs"}},"type":"object","required":["job_id","songs"],"title":"SongsListResponse","description":"Response model for a list of songs."},"UploadUrlResponse":{"properties":{"song_id":{"type":"string","title":"Song Id"},"upload_url":{"type":"string","title":"Upload Url"},"audio_path":{"type":"string","title":"Audio Path"},"content_type":{"type":"string","title":"Content Type"},"expires_in_minutes":{"type":"integer","title":"Expires In Minutes","default":15}},"type":"object","required":["song_id","upload_url","audio_path","content_type"],"title":"UploadUrlResponse","description":"Response model for upload URL."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"},"input":{"title":"Input"},"ctx":{"type":"object","title":"Context"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}